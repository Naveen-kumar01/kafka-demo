[2023-01-30 19:01:59,226] TRACE Broker 2 received LeaderAndIsr request org.apache.kafka.common.requests.LeaderAndIsrRequest$PartitionState@6ae6950 correlation id 1 from controller 0 epoch 1 for partition [test,0] (state.change.logger)
[2023-01-30 19:01:59,242] TRACE Broker 2 handling LeaderAndIsr request correlationId 1 from controller 0 epoch 1 starting the become-leader transition for partition [test,0] (state.change.logger)
[2023-01-30 19:01:59,320] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 0 epoch 1 with correlation id 1 for partition [test,0] (state.change.logger)
[2023-01-30 19:01:59,320] TRACE Broker 2 completed LeaderAndIsr request correlationId 1 from controller 0 epoch 1 for the become-leader transition for partition [test,0] (state.change.logger)
[2023-01-30 19:01:59,338] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,0,LeaderEpoch:0,ControllerEpoch:1),ReplicationFactor:2),AllReplicas:0,2) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 2 (state.change.logger)
[2023-01-30 19:15:14,474] TRACE Broker 2 received LeaderAndIsr request org.apache.kafka.common.requests.LeaderAndIsrRequest$PartitionState@62d689ff correlation id 4 from controller 0 epoch 1 for partition [test,0] (state.change.logger)
[2023-01-30 19:15:14,474] TRACE Broker 2 handling LeaderAndIsr request correlationId 4 from controller 0 epoch 1 starting the become-leader transition for partition [test,0] (state.change.logger)
[2023-01-30 19:15:14,477] INFO Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 4 from controller 0 epoch 1 for partition [test,0] since it is already the leader for the partition. (state.change.logger)
[2023-01-30 19:15:14,478] TRACE Broker 2 completed LeaderAndIsr request correlationId 4 from controller 0 epoch 1 for the become-leader transition for partition [test,0] (state.change.logger)
[2023-01-30 19:15:14,481] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:1,ControllerEpoch:1),ReplicationFactor:2),AllReplicas:0,2) for partition test-0 in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 5 (state.change.logger)
[2023-01-30 19:15:15,446] TRACE Controller 2 epoch 2 changed state of replica 2 for partition [test,0] from OnlineReplica to OnlineReplica (state.change.logger)
[2023-01-30 19:15:15,447] TRACE Controller 2 epoch 2 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:1,ControllerEpoch:1) to broker 2 for partition [test,0] (state.change.logger)
[2023-01-30 19:15:15,451] TRACE Controller 2 epoch 2 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:1,ControllerEpoch:1) to broker 2 for partition test-0 (state.change.logger)
[2023-01-30 19:15:15,453] TRACE Controller 2 epoch 2 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:1,ControllerEpoch:1) to broker 1 for partition test-0 (state.change.logger)
[2023-01-30 19:15:15,463] TRACE Broker 2 received LeaderAndIsr request org.apache.kafka.common.requests.LeaderAndIsrRequest$PartitionState@6492c3e1 correlation id 0 from controller 2 epoch 2 for partition [test,0] (state.change.logger)
[2023-01-30 19:15:15,465] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 2 for partition [test,0] since its associated leader epoch 1 is old. Current leader epoch is 1 (state.change.logger)
[2023-01-30 19:15:15,467] TRACE Controller 2 epoch 2 received response {error_code=0,partitions=[{topic=test,partition=0,error_code=11}]} for a request sent to broker localhost:9094 (id: 2 rack: null) (state.change.logger)
[2023-01-30 19:15:15,467] TRACE Controller 2 epoch 2 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null) (state.change.logger)
[2023-01-30 19:15:15,468] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:1,ControllerEpoch:1),ReplicationFactor:2),AllReplicas:0,2) for partition test-0 in response to UpdateMetadata request sent by controller 2 epoch 2 with correlation id 1 (state.change.logger)
[2023-01-30 19:15:15,469] TRACE Controller 2 epoch 2 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null) (state.change.logger)
[2023-01-30 19:15:15,473] TRACE Controller 2 epoch 2 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:1,ControllerEpoch:1) to broker 2 for partition test-0 (state.change.logger)
[2023-01-30 19:15:15,473] TRACE Controller 2 epoch 2 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:1,ControllerEpoch:1) to broker 1 for partition test-0 (state.change.logger)
[2023-01-30 19:15:15,474] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:1,ControllerEpoch:1),ReplicationFactor:2),AllReplicas:0,2) for partition test-0 in response to UpdateMetadata request sent by controller 2 epoch 2 with correlation id 2 (state.change.logger)
[2023-01-30 19:15:15,475] TRACE Controller 2 epoch 2 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null) (state.change.logger)
[2023-01-30 19:15:15,476] TRACE Controller 2 epoch 2 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null) (state.change.logger)
